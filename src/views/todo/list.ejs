<% layout("layout/boilerplate") -%>
<%- include("../layout/header.ejs") %>

<!-- filter -->
<%- include("./_filter.ejs", query) %>

<!-- list -->
<div class="container mt-2 jumbotron">
  <div class="d-flex justify-content-between align-items-end">
    <h1>Todo list</h1>
    <a class="btn btn-primary" href="/todo/add">Add</a>
  </div>
  <table class="table table-striped mt-2">
    <thead>
      <tr>
        <th scope="col">Task</th>
        <th scope="col">Category</th>
        <th scope="col">Options</th>
      </tr>
    </thead>
    <tbody>
      <% todos.forEach((todo)=>{ %>
        <tr>
          <td><%= todo.task %></td>
          <td><%= todo.category?.name || "Aucune" %></td>
          <td style="width: 30%">
            <button class="btn btn-info">Check</button>
            <a class="btn btn-warning" href="/todo/edit/<%= todo._id %>">Edit</a>
            <form action="/todo/delete" method="POST" class="d-inline">
              <button class="btn btn-danger" name="_id" value="<%= todo._id %>">Delete</button>
            </form>
          </td>
        </tr>
      <% }) %>
  </table>
  <% if(todos.length === 0){ %>
    <p align="center">No todo found</p>
  <% } %>
</div>